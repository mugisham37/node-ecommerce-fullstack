# Fail2Ban Configuration for Application Security

[DEFAULT]
# Ban hosts for 1 hour
bantime = 3600

# A host is banned if it has generated "maxretry" during the last "findtime" seconds
findtime = 600
maxretry = 5

# Destination email for notifications
destemail = admin@example.com
sender = fail2ban@example.com

# Action to take when banning
action = %(action_mwl)s

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 3

[nginx-limit-req]
enabled = true
filter = nginx-limit-req
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 10

[nginx-botsearch]
enabled = true
filter = nginx-botsearch
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2

[api-auth-failures]
enabled = true
filter = api-auth-failures
port = http,https
logpath = /var/log/app/api.log
maxretry = 5
findtime = 300
bantime = 1800

[api-rate-limit]
enabled = true
filter = api-rate-limit
port = http,https
logpath = /var/log/app/api.log
maxretry = 20
findtime = 60
bantime = 300